var e=Object.defineProperty,t=(t,n,l)=>(((t,n,l)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l})(t,"symbol"!=typeof n?n+"":n,l),l);const n=(e,t,n,l,s)=>{j.fillStyle=s,j.fillRect(e,t,n,l)};class l{constructor(e,l){t(this,"draw",((e,t,l)=>{const s=e+t,a=this.point.x*s,r=this.point.y*s;n(a,r,e+t,e+t,l),n(a+t-1,r+t-1,e,e,this.type)})),this.point=new s(e.x,e.y),this.type=l}}class s{constructor(e,n){t(this,"equals",(e=>this.x===e.x&&this.y===e.y)),this.x=e,this.y=n}}class a{constructor(e){t(this,"f",0),t(this,"g",0),t(this,"h",0),t(this,"parent",null),t(this,"calculateDest",(e=>{const t=Math.abs(this.p.x-e.x),n=Math.abs(this.p.y-e.y);this.h=1*(t+n)+(Math.sqrt(2)-2)*Math.min(t,n)})),t(this,"calculateF",((e,t)=>{this.g=e.g+1,this.calculateDest(t),this.f=this.g+this.h})),this.p=new s(e.x,e.y)}}const r=(e,t)=>t.y>=0&&t.y<e.length&&t.x>=0&&t.x<e[t.y].length;let o;const i=(e,t,n,l,o,i)=>{if(!((e,t,n)=>{if(r(e,t)&&1!==e[t.y][t.x]){if(t.x!==n.x&&t.y!==n.y){const l=new s(n.x+(t.x-n.x),n.y),a=new s(n.x,n.y+(t.y-n.y));if(r(e,l)&&r(e,a)&&1===e[l.y][l.x]&&1===e[a.y][a.x])return!1}return!0}return!1})(e,l,o.p)||n[l.y][l.x])return!1;{let s=new a(l);if(s.parent=o,l.equals(i))return console.log("done"),((e,t)=>{console.log(t);let n=t.parent;for(;n.parent;)e[n.p.y][n.p.x]=4,n=n.parent})(e,s),!0;s.calculateF(o,i);const r=t.findIndex((e=>s.p.equals(e.p)));if(-1!==r&&t[r].f<s.f)return!1;const c=n[s.p.y][s.p.x];if(c&&c.f<s.f)return!1;-1!==r&&(t=t.filter(((e,t)=>t!==r))),t.push(s)}},c=e=>Math.round(Math.random()*(e-1));let p,h,y,u=10,d=10,g=38,x=g+2,w=!1;const f=()=>{o=null,p=new s(c(d),c(u)),h=new s(c(d),c(u)),y=new Array(u);for(let e=0;e<u;e++){y[e]=new Array(d);for(let t=0;t<d;t++)p.equals(new s(t,e))?y[e][t]=2:h.equals(new s(t,e))?y[e][t]=3:100*Math.random()>75?y[e][t]=1:y[e][t]=0}console.log(y,p,h,c(d))},v=()=>{y=y.map((e=>e.map((e=>e>3?0:e))))},m=e=>{"STEP"===e.type?w||(v(),w=!0):(v(),w=!1),console.log("step started",w),((e,t,n,l)=>{let r,c,p=[],h=new Array(e.length).fill(0).map((t=>new Array(e.length))),y=!1;p.push(new a(t));const u=()=>{if((y||p.length<=0)&&r)return void clearInterval(r);let a,u={v:1/0,i:-1};return p.forEach(((n,l)=>{n.p.equals(t)||(e[n.p.y][n.p.x]=6),n.f<u.v&&(u.v=n.f,u.i=l)})),a=p[u.i],a.p.equals(t)||(e[a.p.y][a.p.x]=4),!c||c.equals(t)||c.equals(a.p)||(e[c.y][c.x]=5),c=new s(a.p.x,a.p.y),p=p.filter(((e,t)=>t!==u.i)),i(e,p,h,new s(a.p.x,a.p.y-1),a,n)||i(e,p,h,new s(a.p.x,a.p.y+1),a,n)||i(e,p,h,new s(a.p.x+1,a.p.y),a,n)||i(e,p,h,new s(a.p.x-1,a.p.y),a,n)||i(e,p,h,new s(a.p.x+1,a.p.y-1),a,n)||i(e,p,h,new s(a.p.x-1,a.p.y-1),a,n)||i(e,p,h,new s(a.p.x+1,a.p.y+1),a,n)||i(e,p,h,new s(a.p.x+1,a.p.y+1),a,n)?(console.log(p,h),void(y=!0)):(h[a.p.y][a.p.x]=a,void("STEP"===l.type&&(o={open:p,closed:h,prevQ:c})))};switch(l.type){case"STEP":o?(p=o.open,h=o.closed,c=o.prevQ):p.length>0&&u(),console.log(p,h,o),p.length>0&&u();break;case"ANIMATION":o=null,r=setInterval(u,1e3/l.speed),p.length<=0&&clearInterval(r);break;default:console.log(`pace: ${l} doesnt exist`)}})(y,p,h,e)},E=e=>{switch(e){case 0:return"white";case 1:return"gray";case 2:return"blue";case 3:return"yellow";case 4:return"purple";case 5:return"pink";case 6:return"red"}},I=()=>{y||f(),g=Q.width/d-2,n(0,0,Q.width,Q.height,"black");for(let e=0,t=0;e<u;e++,t+=x)for(let n=0,a=0;n<d;n++,a+=x){new l(new s(n,e),E(y[e][n])).draw(g,2,"black")}};let b,q,A,M,k,B,L,T=24;const N=e=>()=>{m({type:e,speed:T})},P=()=>{f()},S=e=>{L.value=e.target.value,B.value=L.value,T=L.value},O=e=>{Q.width=e.target.value,Q.height=e.target.value},D=e=>{var t;t=e.target.value,u=t,d=t,y=null};function F(e){let t=this.pop();this[e]=t}const Q=document.getElementsByTagName("canvas").item(0),j=Q.getContext("2d");const z=()=>{I()};window.onload=()=>{b=document.getElementById("play"),q=document.getElementById("step"),A=document.getElementById("random"),M=document.getElementById("size"),k=document.getElementById("cells"),B=document.getElementById("text-speed"),L=document.getElementById("range-speed"),b.addEventListener("click",N("ANIMATION")),q.addEventListener("click",N("STEP")),A.addEventListener("click",P),M.addEventListener("change",O),k.addEventListener("change",D),B.addEventListener("change",S),L.addEventListener("change",S),Array.prototype.removeAt=F,setInterval(z,1e3/30)};
